<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <title>{{ page.title }}</title>
    <script type="text/javascript" src="/kcodeblog/assets/js/knitout-visualizer.js"></script>
    <script type="text/javascript" src="/kcodeblog/assets/js/sidebar.js"></script>
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css" integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous">
    <link rel="stylesheet" href="/kcodeblog/assets/css/code_page.css"/>
  </head>
    <body>
      <div 
      {% if page.is_post %}
      class="holder"
      {% else %}
      class="holder homepage"
      {% endif %}
      >
  		<div id="header_logo" class="header">
  			<a href="{{site.baseurl}}/">
	  			<div id="logo">
					<img src="{{site.baseurl}}/assets/images/letter_mark-02.svg"/>
		  			<h1>kcode blog</h1>
	  			</div>
  			</a>
  		</div>
  		<div id="header_main" class="header">
	  		<div>
	  			<h2>
	  				{{page.category}}
	  			</h2>
	  			<h1>
	  				{{page.title}}
	  			</h1>
          <div class="show_on_small">
            <i class="fas fa-bars"></i>
          </div>
  			</div>
  		</div>
  		<div id="menu">
  			{% include sidebar.html %}
  		</div>
  		<div id="code">
        {% if page.is_post %}
          <img src="{{site.baseurl}}/{{page.image}}"/>
          {% gist  page.js_gist %}
          <script>
            var client = new XMLHttpRequest();
            client.open('GET', 'https://gist.githubusercontent.com/jessp/{{page.knitout_gist}}/raw');
            client.onreadystatechange = function() {
              if(client.readyState === 4 && client.status === 200) {
                      // console.log(document.querySelector("#viz"), client.responseText);
              replaceElement(document.querySelector("#viz"), client.responseText);
                  }
              
            }
            client.send();        
          </script>
        {% endif %}

        {% if page.is_post == false%}
          <div style="padding: 10px">
            {{content}}
          </div>
        {% endif %}
    	</div>
      {% if page.is_post %}
    	<div id="visualization">
          <div id="viz"></div>
          <div class="bottom_text">
            <p><span>Graphic generated by the Carnegie Mellon Textiles Lab's </span><a href = "https://github.com/textiles-lab/knitout-visualizer"><span>Knitout visualizer.</span></a></p>
          </div>
    	</div>
      {% endif %}

      <div class="hidden_menu">

        {% if page.url == "/" %}
            <h2><a href="{{site.baseurl}}/" class="active">HOME</a></h2>
        {% else %}
            <h2><a href="{{site.baseurl}}/">HOME</a></h2>
        {% endif %}

        {% include sidebar.html %}
      </div>
    </div>
      
      <script>

        const menuIcon = document.querySelector(".show_on_small");
        const hidden_menu = document.querySelector(".hidden_menu");

        menuIcon.addEventListener('click', event => {
          toggleClass(hidden_menu, "visible");
        });

        function toggleClass(el, className){
          if (el.classList) {
            el.classList.toggle(className);
          } else {
            var classes = el.className.split(' ');
            var existingIndex = classes.indexOf(className);

            if (existingIndex >= 0)
              classes.splice(existingIndex, 1);
            else
              classes.push(className);

            el.className = classes.join(' ');
          }
        }


      </script>

  </body>
</html>